
@model IEnumerable<DoAnWebThiTracNghiem.Models.Exam>

@{
    ViewData["Title"] = "Danh sách bài thi";
    Layout = "~/Areas/Teacher/Views/Shared/_layout.cshtml";
}
<div class="mx-auto max-w-7xl py-8">
    <h2 class="mb-6 text-center text-2xl font-bold">Danh sách bài thi</h2>

    <div class="mb-6 flex flex-col items-center gap-4 md:flex-row md:justify-between">
        <a asp-action="CreateWithQuestions" class="rounded bg-green-500 px-6 py-2 font-semibold text-white shadow transition hover:bg-green-600">
            Thêm mới
        </a>
        <form asp-action="Index" method="get" class="flex w-full gap-2 md:w-auto">
            <input type="text" name="search" class="w-full rounded border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-400 md:w-64" placeholder="Tìm kiếm bài thi hoặc môn học..." value="@(Context.Request.Query["search"])" />
            <button type="submit" class="rounded bg-orange-500 px-4 py-2 font-semibold text-white transition hover:bg-orange-600">Tìm</button>
        </form>
    </div>

    @if (TempData["SuccessMessage"] != null)
    {
        <div class="mb-4 rounded bg-green-100 p-3 text-green-700 shadow">@TempData["SuccessMessage"]</div>
    }

    <div class="grid grid-cols-1 gap-6 sm:grid-cols-2 md:grid-cols-3">
        @foreach (var exam in Model)
        {
            <div class="border-2 flex flex-col rounded-lg border-green-400 bg-white shadow-lg transition hover:shadow-2xl">
                <div class="rounded-t-lg border-b-2 border-purple-400 bg-purple-100 p-3 text-center text-lg font-bold">
                    @exam.Exam_Name
                </div>
                <div class="flex-1 p-4">
                    <ul class="mb-4 space-y-1 text-gray-700">
                        <li>- Số câu hỏi: <span class="font-semibold">@exam.TotalQuestions</span></li>
                        <li>- Môn học: <span class="font-semibold">@exam.Subject?.Subject_Name</span></li>
                        <li>- Thời gian làm bài: <span class="font-semibold">@exam.Duration phút</span></li>
                        <li>- Ngày thi: <span class="font-semibold">@exam.Exam_Date.ToString("dd/MM/yyyy HH:mm")</span></li>
                        <li>
                            - Trạng thái:
                            <span class="inline-block rounded px-2 py-1 text-xs font-bold @(exam.IsActive ? "bg-green-200 text-green-800" : "bg-gray-200 text-gray-600")">
                                @(exam.IsActive ? "Đang hoạt động" : "Không hoạt động")
                            </span>
                        </li>
                    </ul>
                    <div class="flex justify-center gap-4">
                        <a asp-action="ManageExam" asp-route-examId="@exam.Exam_ID"
                           class="rounded-full bg-green-200 p-3 text-green-900 shadow transition hover:bg-green-400"
                           title="Quản lý bài thi">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-4.35-4.35m0 0A7.5 7.5 0 104.5 4.5a7.5 7.5 0 0012.15 12.15z" />
                            </svg>
                        </a>
                        <button type="button"
                                class="rounded-full bg-orange-200 p-3 text-orange-900 shadow transition hover:bg-orange-400"
                                onclick="confirmDelete('@exam.Exam_ID', '@exam.Exam_Name')"
                                title="Xóa bài thi">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        }
    </div>

    <form id="deleteForm" method="post" asp-action="Delete">
        <input type="hidden" name="id" id="deleteExamId" />
    </form>
</div>

@section Scripts {
    <script>
        function confirmDelete(examId, examName) {
            if (confirm('Bạn có muốn xóa bài thi "' + examName + '" không?')) {
                document.getElementById('deleteExamId').value = examId;
                document.getElementById('deleteForm').submit();
            }
        }
    </script>
}






